Found 139 migration files

Successfully parsed 139 migrations

================================================================================
MIGRATION STRUCTURE ANALYSIS
================================================================================

ğŸ“ HEADS (migrations with no children): 42
   - 0011_jobs_an (0011_jobs_and_export_replay.py)
   - 0042_photo_r (0042_photo_review_and_signing.py)
   - 0048_dispatc (0048_dispatcher_comm_audits.py)
   - 0049_invoice (0049_invoice_tax_snapshots.py)
   - 0049_stripe_ (0049_stripe_event_metadata.py)
   - 0052_stripe_ (0052_stripe_events_processed.py)
   - 0065 (0065_add_client_users_org_id.py)
   - 0067 (0067_event_logs_booking_fk_cascade.py)
   - 0080_booking (0080_booking_address_usage_and_address_defaults.py)
   - 0081_merge_h (0081_merge_heads_0048_and_0080.py)
   - 0085_iam_rol (0085_iam_roles_permissions.py)
   - 0085_org_set (0085_org_settings_core.py)
   - 0085_pricing (0085_pricing_policies_settings.py)
   - 0086_client_ (0086_client_users_rls_org_isolation.py)
   - 0086_merge_0 (0086_merge_0085_heads.py)
   - 0088_client_ (0088_client_users_rls_from_bookings.py)
   - 1a6b6e3f2c2c (1a6b6e3f2c2c_add_billing_pause_fields.py)
   - 2c3b4b9a1e9a (2c3b4b9a1e9a_add_client_users_is_active.py)
   - 34d313a57aa7 (34d313a57aa7_merge_heads_iam_prior_merge.py)
   - 5d8c3a1b9e21 (5d8c3a1b9e21_notifications_rules_presets.py)
   - 6a2b1c6f3c2b (6a2b1c6f3c2b_availability_blocks.py)
   - 7a4c2d1f8e3b (7a4c2d1f8e3b_notifications_digest_settings.py)
   - 7f871a8d46f5 (7f871a8d46f5_merge_alembic_heads.py)
   - 9a5e2c8c64c0 (9a5e2c8c64c0_perf_queue_indexes.py)
   - 9f2b7c4d1a0e (9f2b7c4d1a0e_team_settings_fields.py)
   - a1b2c3d4e5f6 (a1b2c3d4e5f6_placeholder_head.py)
   - a2b3c4d5e6f7 (a2b3c4d5e6f7_add_finance_tax_tables.py)
   - a7c3b9d2e1f0 (a7c3b9d2e1f0_add_gcal_sync_foundation.py)
   - b1c2d3e4f5a6 (b1c2d3e4f5a6_placeholder_head.py)
   - b8e1c2d3f4a5 (b8e1c2d3f4a5_merge_heads_34d313a57aa7_6a2b1c6f3c2b.py)
   - b9c8d7e6f5a4 (b9c8d7e6f5a4_add_inventory_suppliers.py)
   - c1a2b3c4d5e6 (c1a2b3c4d5e6_add_rules_and_rule_runs.py)
   - c2a1b3d4e5f6 (c2a1b3d4e5f6_add_lead_touchpoints.py)
   - c4d5e6f7a8b9 (c4d5e6f7a8b9_add_inventory_consumption.py)
   - c7d8e9f0a1b2 (c7d8e9f0a1b2_add_competitor_benchmarking.py)
   - c8d2e4f6a1b3 (c8d2e4f6a1b3_add_leads_nurture_foundation.py)
   - c9f0a1b2c3d4 (c9f0a1b2c3d4_merge_heads_b1c2d3e4f5a6_b7f4d2e9c1a0.py)
   - cf72c4eb59bc (cf72c4eb59bc_placeholder_head.py)
   - d4e5f6a7b8c9 (d4e5f6a7b8c9_merge_heads_a1b2_b1c2_c9f0_cf72.py)
   - e1f2a3b4c5d6 (e1f2a3b4c5d6_merge_heads_a1b2_b1c2_cf72_d4e5.py)
   - e2b1c4d5f6a7 (e2b1c4d5f6a7_add_lead_scoring_tables.py)
   - f83f22a8223b (f83f22a8223b_merge_alembic_heads.py)

ğŸŒ± ROOTS (migrations with no parents): 19
   - 0001_initial (0001_initial.py)
   - 0081_merge_h (0081_merge_heads_0048_and_0080.py)
   - 0082_merge_h (0082_merge_heads_0081_and_9c1b2f4a8d0b.py)
   - 0086_merge_0 (0086_merge_0085_heads.py)
   - 03149fcdd67f (03149fcdd67f_merge_heads_5d8c3a1b9e21_and_.py)
   - 34d313a57aa7 (34d313a57aa7_merge_heads_iam_prior_merge.py)
   - 3cbbc3fa5729 (3cbbc3fa5729_merge_alembic_heads.py)
   - 4a939bab6876 (4a939bab6876_merge_heads_0067_and_2c3b4b9a1e9a.py)
   - 6565fde00428 (6565fde00428_merge_heads.py)
   - 96339be46688 (96339be46688_merge_alembic_heads.py)
   - a2cce6391ad9 (a2cce6391ad9_merge_alembic_heads_0049.py)
   - b8e1c2d3f4a5 (b8e1c2d3f4a5_merge_heads_34d313a57aa7_6a2b1c6f3c2b.py)
   - bc6a9a9f5c2b (bc6a9a9f5c2b_merge_heads_1a6b_and_9a5e.py)
   - c4b6c7ab0034 (c4b6c7ab0034_merge_heads_9f2b7c4d1a0e_and_.py)
   - d4e5f6a7b8c9 (d4e5f6a7b8c9_merge_heads_a1b2_b1c2_c9f0_cf72.py)
   - e1f2a3b4c5d6 (e1f2a3b4c5d6_merge_heads_a1b2_b1c2_cf72_d4e5.py)
   - f1e2d3c4b5a6 (f1e2d3c4b5a6_merge_heads_a1b2_b1c2_cf72_e1f2.py)
   - f83f22a8223b (f83f22a8223b_merge_alembic_heads.py)
   - f8dba77650d4 (f8dba77650d4_merge_migration_heads.py)

ğŸ”€ BRANCHES (migrations with multiple children): 12
   - 0010_invoice (0010_invoices.py) -> 2 children:
      â†’ 0011_invoice (0011_invoice_public_tokens.py)
      â†’ 0011_jobs_an (0011_jobs_and_export_replay.py)
   - 0047_break_g (0047_break_glass_sessions.py) -> 2 children:
      â†’ 0048_admin_t (0048_admin_totp_mfa.py)
      â†’ 0048_dispatc (0048_dispatcher_comm_audits.py)
   - 0048_admin_t (0048_admin_totp_mfa.py) -> 2 children:
      â†’ 0049_invoice (0049_invoice_tax_snapshots.py)
      â†’ 0049_stripe_ (0049_stripe_event_metadata.py)
   - bc6a9a9f5c2b (bc6a9a9f5c2b_merge_heads_1a6b_and_9a5e.py) -> 3 children:
      â†’ 0050_data_ri (0050_data_rights_tables.py)
      â†’ 0064 (0064_add_worker_password_hash.py)
      â†’ 9c1b2f4a8d0b (9c1b2f4a8d0b_client_address_coords.py)
   - 0084_feature (0084_feature_modules_visibility.py) -> 3 children:
      â†’ 0085_iam_rol (0085_iam_roles_permissions.py)
      â†’ 0085_org_set (0085_org_settings_core.py)
      â†’ 0085_pricing (0085_pricing_policies_settings.py)
   - a2cce6391ad9 (a2cce6391ad9_merge_alembic_heads_0049.py) -> 2 children:
      â†’ 1a6b6e3f2c2c (1a6b6e3f2c2c_add_billing_pause_fields.py)
      â†’ 9a5e2c8c64c0 (9a5e2c8c64c0_perf_queue_indexes.py)
   - f8dba77650d4 (f8dba77650d4_merge_migration_heads.py) -> 2 children:
      â†’ 2c3b4b9a1e9a (2c3b4b9a1e9a_add_client_users_is_active.py)
      â†’ 6a2b1c6f3c2b (6a2b1c6f3c2b_availability_blocks.py)
   - 1b2c3d4e5f6a (1b2c3d4e5f6a_quality_issue_tag_position.py) -> 2 children:
      â†’ 4c2b1c9e7d8a (4c2b1c9e7d8a_notifications_center_events.py)
      â†’ 7a4c2d1f8e3b (7a4c2d1f8e3b_notifications_digest_settings.py)
   - aa12b3cd45ef (aa12b3cd45ef_add_marketing_spend_and_email_manual.py) -> 4 children:
      â†’ a1b2c3d4e5f6 (a1b2c3d4e5f6_placeholder_head.py)
      â†’ b1c2d3e4f5a6 (b1c2d3e4f5a6_placeholder_head.py)
      â†’ b7f4d2e9c1a0 (b7f4d2e9c1a0_add_training_requirements_records.py)
      â†’ cf72c4eb59bc (cf72c4eb59bc_placeholder_head.py)
   - f9c1d2e3a4b5 (f9c1d2e3a4b5_add_finance_cash_snapshots.py) -> 6 children:
      â†’ a2b3c4d5e6f7 (a2b3c4d5e6f7_add_finance_tax_tables.py)
      â†’ a7c3b9d2e1f0 (a7c3b9d2e1f0_add_gcal_sync_foundation.py)
      â†’ b2c3d4e5f6a7 (b2c3d4e5f6a7_add_maps_usage.py)
      â†’ c1a2b3c4d5e6 (c1a2b3c4d5e6_add_rules_and_rule_runs.py)
      â†’ c8d2e4f6a1b3 (c8d2e4f6a1b3_add_leads_nurture_foundation.py)
      â†’ f2c3d4e5f6a7 (f2c3d4e5f6a7_nps_tokens_public_submit.py)
   - f1e2d3c4b5a6 (f1e2d3c4b5a6_merge_heads_a1b2_b1c2_cf72_e1f2.py) -> 2 children:
      â†’ a9a9247301a9 (a9a9247301a9_merge_heads_a1b2c3d4e5f6_b1c2d3e4f5a6_.py)
      â†’ f9c1d2e3a4b5 (f9c1d2e3a4b5_add_finance_cash_snapshots.py)
   - a9a9247301a9 (a9a9247301a9_merge_heads_a1b2c3d4e5f6_b1c2d3e4f5a6_.py) -> 2 children:
      â†’ b2f3c4d5e6f7 (b2f3c4d5e6f7_add_purchase_orders.py)
      â†’ b9c8d7e6f5a4 (b9c8d7e6f5a4_add_inventory_suppliers.py)

ğŸ”„ CYCLES: 0
   âœ“ No cycles detected

âŒ BROKEN CHAINS (references to missing revisions): 3
   - 0088_client_ (0088_client_users_rls_from_bookings.py) references missing: 0087_client_
   - c7d8e9f0a1b2 (c7d8e9f0a1b2_add_competitor_benchmarking.py) references missing: b5c6d7e8f9a0
   - e2b1c4d5f6a7 (e2b1c4d5f6a7_add_lead_scoring_tables.py) references missing: d8f2e3a4b5c6

================================================================================
MIGRATION TREE STRUCTURE
================================================================================

=== Root: 0001_initial ===
â— 0001_initial - initial
â””â”€   â— 0002_slots_v - slots v1 tables
â””â”€   â””â”€     â— 0003_email_e - email events table
â””â”€   â””â”€     â””â”€       â— 0004_lead_st - add lead status column
â””â”€   â””â”€     â””â”€       â””â”€         â— 0005_deposit - deposit policy and stripe fields
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â— 0006_event_l - event logs and actual duration
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â— 0007_referra - add referral codes and credits
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â— 0008_default - make team name unique and seed default
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â— 0009_export_ - Add export_events dead-letter table
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   ğŸ”€ 0010_invoice - Add invoices, invoice items, and payments tables
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â— 0011_invoice - Add invoice public tokens
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â— 0012_stripe_ - stripe invoice payments
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â— 0013_time_tr - time tracking tables and planned minutes
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â— 0014_checkli - checklist tables
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â— 0015_order_p - order photos and consent flag
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â— 0016_reason_ - reason logs table
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â— 0017_client_ - Add client users and attach to bookings
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â— 0018_subscri - subscriptions
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â— 0019_addons - add addons tables
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â— 0020_nps_and - add nps responses and support tickets
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â— 0021_booking - Add policy snapshot to bookings
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â— 0022_booking - add risk scoring fields to bookings
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â— 0023_policy_ - add audit trail for policy overrides
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â— 0024_dispute - add disputes schema and financial tracking columns
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â— 0025_admin_a - admin audit logs
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â— 0026_documen - Add document templates and issued documents
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â— 0027_workers - workers and booking assignment
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â— 0028_team_sc - team working hours and blackouts tables
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â— 0029_invoice - invoice payments support bookings and stripe refs
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â— 0030_email_e - Add invoice scope to email events
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â— 0031_saas_mu - SaaS multitenant auth foundation.
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â— 0032_saas_bi - Revision ID: 0032_saas_billing_and_limits
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â— 0033_jobs_ru - Revision ID: 0033_jobs_runner_heartbeat
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â””â”€                                                                   â— 0034_org_id_ - Ensure org_id columns use UUID and seed determinis
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â””â”€                                                                   â””â”€                                                                     â— 0035_core_ta - Add org_id to core business tables with backfill a
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â””â”€                                                                   â””â”€                                                                     â””â”€                                                                       â— 0036_stripe_ - Add org_id to Stripe events for scoping.
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â””â”€                                                                   â””â”€                                                                     â””â”€                                                                       â””â”€                                                                         â— 0037_email_d - Add email dedupe keys, DLQ table, and unsubscribe 
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â””â”€                                                                   â””â”€                                                                     â””â”€                                                                       â””â”€                                                                         â””â”€                                                                           â— 0038_order_p - order photo tombstones
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â””â”€                                                                   â””â”€                                                                     â””â”€                                                                       â””â”€                                                                         â””â”€                                                                           â””â”€                                                                             â— 0039_auth_ha - Auth hardening sessions and token audit
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â””â”€                                                                   â””â”€                                                                     â””â”€                                                                       â””â”€                                                                         â””â”€                                                                           â””â”€                                                                             â””â”€                                                                               â— 0040_order_p - Add storage provider and key to order photos
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â””â”€                                                                   â””â”€                                                                     â””â”€                                                                       â””â”€                                                                         â””â”€                                                                           â””â”€                                                                             â””â”€                                                                               â””â”€                                                                                 â— 0041_temp_pa - temp password enforcement and audit
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â”œâ”€                     â””â”€                       â””â”€                         â””â”€                           â””â”€                             â””â”€                               â””â”€                                 â””â”€                                   â””â”€                                     â””â”€                                       â””â”€                                         â””â”€                                           â””â”€                                             â””â”€                                               â””â”€                                                 â””â”€                                                   â””â”€                                                     â””â”€                                                       â””â”€                                                         â””â”€                                                           â””â”€                                                             â””â”€                                                               â””â”€                                                                 â””â”€                                                                   â””â”€                                                                     â””â”€                                                                       â””â”€                                                                         â””â”€                                                                           â””â”€                                                                             â””â”€                                                                               â””â”€                                                                                 â””â”€                                                                                   ğŸ”´ 0042_photo_r - Photo review workflow and signing fields
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â””â”€                     ğŸ”´ 0011_jobs_an - Add job status tracking and export replay metadata

=== Root: 0081_merge_h ===
ğŸ”´ 0081_merge_h - Merge alembic heads 0048 and 0080

=== Root: 0082_merge_h ===
â— 0082_merge_h - Merge heads 0081_merge_heads_0048_and_0080 and 9c1
â””â”€   â— 0083_dispatc - Add dispatcher alert state table.
â””â”€   â””â”€     ğŸ”€ 0084_feature - Add org feature configs and user UI preferences.
â””â”€   â””â”€     â”œâ”€       ğŸ”´ 0085_iam_rol - Add IAM roles and custom role assignments.
â””â”€   â””â”€     â”œâ”€       ğŸ”´ 0085_org_set - Org settings core
â””â”€   â””â”€     â””â”€       ğŸ”´ 0085_pricing - Add service catalog and booking policy settings.

=== Root: 0086_merge_0 ===
ğŸ”´ 0086_merge_0 - Merge 0085 heads.

=== Root: 03149fcdd67f ===
â— 03149fcdd67f - merge heads 5d8c3a1b9e21 and 7a4c2d1f8e3b
â””â”€   â— c2f4b8a1d9e0 - add lead pipeline fields
â””â”€   â””â”€     â— d3b7c1a4f8e2 - add lead quotes and loss reason
â””â”€   â””â”€     â””â”€       â— e6b1c2d3f4a5 - add promo codes and redemptions
â””â”€   â””â”€     â””â”€       â””â”€         â— f0b1c2d3e4f5 - add digest state and referral credit trigger
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           ğŸ”€ aa12b3cd45ef - add marketing spend and email manual tables
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â”œâ”€             ğŸ”´ a1b2c3d4e5f6 - placeholder head for merge
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â”œâ”€             ğŸ”´ b1c2d3e4f5a6 - placeholder head for merge
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â”œâ”€             â— b7f4d2e9c1a0 - add training requirements and records
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â”œâ”€             â””â”€               ğŸ”´ c9f0a1b2c3d4 - merge heads b7f4d2e9c1a0
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             ğŸ”´ cf72c4eb59bc - placeholder head for merge

=== Root: 34d313a57aa7 ===
ğŸ”´ 34d313a57aa7 - merge heads (iam + prior merge)

=== Root: 3cbbc3fa5729 ===
â— 3cbbc3fa5729 - merge alembic heads
â””â”€   ğŸ”´ 7f871a8d46f5 - merge alembic heads

=== Root: 4a939bab6876 ===
â— 4a939bab6876 - merge heads 0067 and 2c3b4b9a1e9a
â””â”€   â— 0068_add_tea - add archived_at to teams and workers
â””â”€   â””â”€     â— 0069_add_boo - add archived_at to bookings
â””â”€   â””â”€     â””â”€       â— 0070_add_wor - add worker skills and ratings
â””â”€   â””â”€     â””â”€       â””â”€         â— 0071_worker_ - add worker reviews and notes
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â— 0072_worker_ - add worker onboarding and certificates
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â— 0073_client_ - add client notes, tags, and blocked status
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â— 0074_direct_ - direct admin worker chat tables
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â— 0075_message - message templates
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â— 0076_client_ - add client note types
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â””â”€                     â— 0077_client_ - add client addresses
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â””â”€                     â””â”€                       â— 0078_client_ - add client feedback
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â””â”€                     â””â”€                       â””â”€                         â— 0079_chat_pa - chat participant keys and org defaults
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â””â”€             â””â”€               â””â”€                 â””â”€                   â””â”€                     â””â”€                       â””â”€                         â””â”€                           ğŸ”´ 0080_booking - add booking address usage and defaults

=== Root: 6565fde00428 ===
â— 6565fde00428 - merge heads
â””â”€   â— 0066 - add booking_workers join table
â””â”€   â””â”€     ğŸ”´ 0067 - Add cascade delete for event_logs booking FK.

=== Root: 96339be46688 ===
â— 96339be46688 - merge alembic heads
â””â”€   â— 0043_subscri - add subscription status reason
â””â”€   â””â”€     â— 0044_postgre - add org isolation rls
â””â”€   â””â”€     â””â”€       â— 0045_outbox_ - Outbox events table
â””â”€   â””â”€     â””â”€       â””â”€         â— 0046_admin_i - Admin idempotency table
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           ğŸ”€ 0047_break_g - Break glass sessions table
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â”œâ”€             ğŸ”€ 0048_admin_t - Admin TOTP MFA for SaaS users
â””â”€   â””â”€     â””â”€       â””â”€         â””â”€           â”œâ”€             â”œâ”€               ğŸ”´ 0049_invoice - Invoice tax snapshots

... (51 more lines)

================================================================================
RECOMMENDATIONS
================================================================================

âš ï¸  CRITICAL: Multiple heads detected!
   Found 42 heads. This will cause issues with migrations.

   SOLUTION: Create a merge migration using:
   alembic merge -m 'merge multiple heads' 0011_jobs_an 0042_photo_r 0048_dispatc 0049_invoice 0049_stripe_ 0052_stripe_ 0065 0067 0080_booking 0081_merge_h 0085_iam_rol 0085_org_set 0085_pricing 0086_client_ 0086_merge_0 0088_client_ 1a6b6e3f2c2c 2c3b4b9a1e9a 34d313a57aa7 5d8c3a1b9e21 6a2b1c6f3c2b 7a4c2d1f8e3b 7f871a8d46f5 9a5e2c8c64c0 9f2b7c4d1a0e a1b2c3d4e5f6 a2b3c4d5e6f7 a7c3b9d2e1f0 b1c2d3e4f5a6 b8e1c2d3f4a5 b9c8d7e6f5a4 c1a2b3c4d5e6 c2a1b3d4e5f6 c4d5e6f7a8b9 c7d8e9f0a1b2 c8d2e4f6a1b3 c9f0a1b2c3d4 cf72c4eb59bc d4e5f6a7b8c9 e1f2a3b4c5d6 e2b1c4d5f6a7 f83f22a8223b

   Or use the full revision IDs:
   - 0011_jobs_and_export_replay
   - 0042_photo_review_and_signing
   - 0048_dispatcher_comm_audits
   - 0049_invoice_tax_snapshots
   - 0049_stripe_event_metadata
   - 0052_stripe_events_processed
   - 0065
   - 0067
   - 0080_booking_address_usage_and_address_defaults
   - 0081_merge_heads_0048_and_0080
   - 0085_iam_roles_permissions
   - 0085_org_settings_core
   - 0085_pricing_policies_settings
   - 0086_client_users_rls_org_isolation
   - 0086_merge_0085_heads
   - 0088_client_users_rls_from_bookings
   - 1a6b6e3f2c2c
   - 2c3b4b9a1e9a
   - 34d313a57aa7
   - 5d8c3a1b9e21
   - 6a2b1c6f3c2b
   - 7a4c2d1f8e3b
   - 7f871a8d46f5
   - 9a5e2c8c64c0
   - 9f2b7c4d1a0e
   - a1b2c3d4e5f6
   - a2b3c4d5e6f7
   - a7c3b9d2e1f0
   - b1c2d3e4f5a6
   - b8e1c2d3f4a5
   - b9c8d7e6f5a4
   - c1a2b3c4d5e6
   - c2a1b3d4e5f6
   - c4d5e6f7a8b9
   - c7d8e9f0a1b2
   - c8d2e4f6a1b3
   - c9f0a1b2c3d4
   - cf72c4eb59bc
   - d4e5f6a7b8c9
   - e1f2a3b4c5d6
   - e2b1c4d5f6a7
   - f83f22a8223b

âš ï¸  WARNING: 12 branching point(s) detected
   This is normal if merge migrations were created properly.

âŒ ERROR: 3 broken reference(s) detected!
   Some migrations reference non-existent parent revisions.
