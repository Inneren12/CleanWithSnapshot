# Canary Deployment Configuration
# This file controls traffic routing between stable and canary deployments.
# Modify CANARY_WEIGHT to shift traffic percentage to the canary version.

# Traffic weight for canary (0-100)
# 0 = all traffic to stable, 100 = all traffic to canary
CANARY_WEIGHT=0

# Canary image tag (defaults to same as stable if not set)
CANARY_IMAGE_TAG=

# Enable/disable canary deployment
CANARY_ENABLED=false

# Minimum observation time (seconds) at each traffic level before advancing
CANARY_OBSERVATION_TIME=300

# Auto-advance traffic stages (comma-separated percentages)
# Example: 10,25,50,75,100 means: 10% -> 25% -> 50% -> 75% -> 100%
CANARY_TRAFFIC_STAGES=10,25,50,100

# SLO thresholds for automatic rollback
# Error rate threshold (percentage) - triggers rollback if exceeded
CANARY_ERROR_RATE_THRESHOLD=2.0

# P95 latency threshold (milliseconds) - triggers rollback if exceeded
CANARY_LATENCY_P95_THRESHOLD=500

# Enable automatic rollback based on SLO violations
CANARY_AUTO_ROLLBACK=true

# Prometheus endpoint for SLO metrics
PROMETHEUS_URL=${PROMETHEUS_URL:-http://prometheus:9090}

# Version identifier for canary (for metrics labeling)
CANARY_VERSION=
STABLE_VERSION=
